{% extends "base.html" %}
{% block head %}<script src="../../static/js/review.js"></script>{% endblock %}
{% from "jinja_macros/product_listing.html" import list_container %}
{% from "jinja_macros/product_listing.html" import listing %}
{%- macro star() -%}
    <span class="fa fa-star fa-2xl star"></span>
{%- endmacro -%}
{%- macro rating() -%}
    <div class="control" style="padding: 1em; padding-bottom:2em;">
        {% for i in range(0,5) %}
            <a style="color:black" onclick="stars({{ i+1 }})" id="star{{ i+1 }}">{{ star()}}</a>
        {% endfor %}
    </div>
{%- endmacro -%}
{%- macro review(data) -%}
    <div class="card">
        <header class="card-header">
            <p class="card-header-title">{{ data.username }}</p>
            <div class="control" style="padding: 1em; padding-bottom:2em;">
                <div>
                    {% for i in range(0,5) %}
                        {% if i < data.rating %}
                            <b style="color:gold;">
                                {{ star()}}
                            </b>
                        {% else %}
                            <b style="color:black;">
                                {{ star()}}
                            </b>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </header>
        <div class="card-content">{{ data.text }}</div>
    </div>
{%- endmacro -%}
<!-- We want to replace the sidebar -->
{% block sidebar %}
    <p class="menu-label">
        <b>Profile</b>
    </p>
    <ul class="menu-list">
        <li>
            <a href="/user/profile">Profile</a>
        </li>
        <li>
            <a href="/user/orders">Orders</a>
        </li>
    </ul>
{% endblock %}
<!-- The right column, we don't need to rebuild the entire thing -->
{% block right_col %}
    <div class="column is-9"
         style="max-height:fit-content;
                overflow-x:hidden;
                overflow-y:auto">
        <article class="media">
            <figure class="media-left">
                <a href="/product/info/{{ item.serial_number }}" style="color:black;">
                    <img class="center"
                            src="{{ item.image }}"
                            alt="Image for : {{ item.name }}"
                            style="max-height:50em;
                                max-width:12em;
                                height:auto;
                                width:auto;
                                padding-right: 15%">
                </a>
            </figure>
            <div class="media-content">
                <div class="content">
                    <a href="/product/info/{{ item.serial_number }}" style="color:black;">
                        <div class="content">
                            <h3>
                                <strong >{{ item.name }}</strong>
                            </h3>
                            <p class="price">Price = {{ item.price }} kr/bottle</p>
                            <p class="stock">Stock = {{ item.stock }}</p>
                            {% if item.stock > 0 %}
                            <div class="field has-addons" style="padding-top: 2%">
                                <div class="control">
                                    <input class="input" type="text" placeholder="Amount to buy">
                                </div>
                                <div class="control">
                                    <a class="button is-info">Buy</a>
                                </div>
                            </div>
                            {% else %}
                            <fieldset disabled>
                                <div class="field has-addons" style="padding-top: 2%">
                                    <div class="control">
                                        <input class="input" type="text" placeholder="">
                                    </div>
                                    <div class="control">
                                        <a class="button is-info">Out of stock</a>
                                    </div>
                                </div>
                            </fieldset>
                            {% endif %}
                            <p style="padding-top: 2%;">{{ item.description }}</p>
                        </div>
                    </a>
                    
                </div>
                
            </div>
        </article>
        <hr style="border:0;
                   border-top: 1px dotted black"
            class="has-background-grey-lighter"/>
        <div style="padding-top: 2em;">
            <div class="field">
                <label class="label">Add a review</label>
                {{ rating() }}
                <div class="control">
                    <textarea class="textarea" placeholder="Your perfect review here"></textarea>
                </div>
            </div>
            <div class="field is-grouped">
                <div class="control">
                    <button class="button is-link"
                            onclick="submit_review({{ item.serial_number }})">Submit</button>
                </div>
                <div class="control">
                    <button class="button is-link is-light" onclick="window.location.href = '/'">Cancel</button>
                </div>
            </div>
        </div>
        <div style="padding-top: 2em;">
            <p style="font-size:30px; text-align:center; padding-bottom:1em;">
                <strong>Reviews</strong>
            </p>
            {% for r in reviews %}
                {{ review(r) }}
                <hr style="border: 0;
                           border-top:1px dotted black"
                    class="has-background-grey-lighter"/>
            {% endfor %}
        </div>
    {% endblock %}
